# LiuTech AI Service 配置
# 作者: 刘鑫
# 时间: 2025-01-31

server:
  port: 8081
spring:
  application:
    name: LiuTech-AI
  profiles:
    active: dev
  mvc:
    async:
      request-timeout: 120s
  # 数据库连接池优化配置
  datasource:
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
      leak-detection-threshold: 60000
  ai:
    openai:
      base-url: https://api.siliconflow.cn
      api-key: "sk-mgeqjwqoregdyyngyospzepxvidnkapkxupvatavqzhtcujo"
      chat:
        options:
          model: "THUDM/GLM-Z1-9B-0414"
          temperature: 0.2
    # 提示词配置
    prompt:
      system-role: "你是原神角色纳西妲"
      behavior-guidelines: |
        1. 必须符合你的人设
      json-output-instruction: |
        回复格式：正常聊天
    # 聊天配置
    chat:
      history-limit: 19
  
# MyBatis-Plus 配置
mybatis-plus:
  # Mapper XML 文件位置
  mapper-locations: classpath:/mapper/**/*.xml
  # 实体类包路径
  type-aliases-package: chat.liuxin.ai.entity
  configuration:
    # 开启驼峰命名转换
    map-underscore-to-camel-case: true
    # SQL 日志输出实现类
    # log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
  global-config:
    db-config:
      # 主键生成策略
      id-type: auto
      # 表名下划线转换
      table-underline: true
      # 逻辑删除值
      logic-delete-value: 1
      # 逻辑未删除值
      logic-not-delete-value: 0

# JWT 配置
jwt:
  secret: liutech2024secretkey-very-long-and-secure-key-for-hmac-sha256-algorithm-minimum-256-bits
  expiration: 604800000  # 7天，单位：毫秒
  header: Authorization
  prefix: Bearer

# 日志配置
logging:
  level:
    chat.liuxin.ai: DEBUG
    org.springframework.ai: DEBUG
    org.springframework.retry: DEBUG
    # 屏蔽MyBatis的SQL日志
    chat.liuxin.ai.mapper: ERROR
    com.baomidou.mybatisplus: ERROR
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
  file:
    name: logs/liutech-ai.log
    max-size: 100MB
    max-history: 30

# 管理端点配置
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: always
  health:
    defaults:
      enabled: true




